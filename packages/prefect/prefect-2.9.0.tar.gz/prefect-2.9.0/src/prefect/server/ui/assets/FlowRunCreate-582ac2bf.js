import{aC as S,a as D,k as F,M as I,aD as N,c,aE as P,$ as b,u as a,b as x,w as d,h as O,e as V,A,o as B,l as i,aF as G,aG as J,aH as M,aI as T,W as y,aA as f}from"./index-46ac39cf.js";import{u as $}from"./usePageTitle-c7478bfe.js";class U extends S{parse(t){return JSON.parse(decodeURIComponent(t??""))}format(t){return encodeURIComponent(JSON.stringify(t))}}const H=D({__name:"FlowRunCreate",setup(h){const t=F(),s=I("deploymentId"),n=A(),m=N("parameters",U,void 0),w=c(()=>!e.value||!m.value?{}:P.map("SchemaValuesResponse",{schema:e.value.parameterOpenApiSchema,values:m.value},"SchemaValues")),R=b(t.deployments.getDeployment,[s]),e=c(()=>R.response),_=async r=>{var l,o;try{const u=await t.deployments.createDeploymentFlowRun(s.value,r),p=((o=(l=r.state)==null?void 0:l.stateDetails)==null?void 0:o.scheduledTime)??void 0,g=!p,k=M(T,{flowRun:u,flowRunRoute:y.flowRun,router:n,immediate:g,startTime:p});f(k,"success"),n.push(y.deployment(s.value))}catch(u){f("Something went wrong trying to create a flow run","error"),console.error(u)}},v=()=>{n.back()},C=c(()=>e.value?`Create Flow Run for Deployment: ${e.value.name}`:"Create Flow Run for Deployment");return $(C),(r,l)=>{const o=V("p-layout-default");return a(e)?(B(),x(o,{key:0},{header:d(()=>[i(a(G),{deployment:a(e)},null,8,["deployment"])]),default:d(()=>[i(a(J),{deployment:a(e),parameters:a(w),onSubmit:_,onCancel:v},null,8,["deployment","parameters"])]),_:1})):O("",!0)}}});export{H as default};
