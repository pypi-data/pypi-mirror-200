"use strict";(self.webpackChunkipylab=self.webpackChunkipylab||[]).push([[856,291],{856:(e,s,i)=>{i.r(s),i.d(s,{CommandPaletteModel:()=>_,CommandRegistryModel:()=>m,IconModel:()=>z,IconView:()=>x,JupyterFrontEndModel:()=>c,PanelModel:()=>u,SessionManagerModel:()=>r,ShellModel:()=>p,SplitPanelModel:()=>f,SplitPanelView:()=>O,TitleModel:()=>y});var t,n,o=i(953),l=i(425),d=i(918),a=i(657);class m extends l.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:m.model_name,_model_module:m.model_module,_model_module_version:m.model_module_version,_command_list:[],_commands:[]})}initialize(e,s){this._commands=m.commands,super.initialize(e,s),this.on("msg:custom",this._onMessage.bind(this)),this.on("comm_live_update",(()=>{this.comm_live||(t.customCommands.values().forEach((e=>e.dispose())),this._sendCommandList())}));const i=this.get("_commands");Promise.all(i.map((e=>this._addCommand(e)))).then((()=>this._sendCommandList())).catch(console.warn)}async _onMessage(e){switch(e.func){case"execute":this._execute(e.payload);break;case"addCommand":{await this._addCommand(e.payload);const s=this.get("_commands");this.set("_commands",s.concat(e.payload)),this.save_changes();break}case"removeCommand":this._removeCommand(e.payload)}}_sendCommandList(){this._commands.notifyCommandChanged(),this.set("_command_list",this._commands.listCommands()),this.save_changes()}_execute(e){const{id:s,args:i}=e;this._commands.execute(s,i)}async _addCommand(e){var s;const{id:i,caption:n,label:o,iconClass:d,icon:a}=e;this._commands.hasCommand(i)&&t.customCommands.get(i).dispose();let m=null;a&&(m=null===(s=await(0,l.unpack_models)(a,this.widget_manager))||void 0===s?void 0:s.labIcon);const _=e=>!e.isDisposed&&!!this.comm&&this.comm_live,r=this._commands.addCommand(i,{caption:n,label:o,iconClass:d,icon:m,execute:()=>{this.comm_live?this.send({event:"execute",id:i},{}):r.dispose()},isEnabled:()=>_(r),isVisible:()=>_(r)});t.customCommands.set(i,r),this._sendCommandList()}_removeCommand(e){const{id:s}=e;t.customCommands.has(s)&&t.customCommands.get(s).dispose();const i=this.get("_commands").slice();d.ArrayExt.removeAllWhere(i,(e=>e.id===s)),this.set("_commands",i),this.save_changes(),this._sendCommandList()}}m.serializers=Object.assign({},l.WidgetModel.serializers),m.model_name="CommandRegistryModel",m.model_module=a.o,m.model_module_version=a.Y,m.view_name=null,m.view_module=null,m.view_module_version=a.Y,function(e){e.customCommands=new o.ObservableMap}(t||(t={}));class _ extends l.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:_.model_name,_model_module:_.model_module,_model_module_version:_.model_module_version,_items:[]})}initialize(e,s){this._palette=_.palette,super.initialize(e,s),this.on("msg:custom",this._onMessage.bind(this)),this.get("_items").forEach((e=>this._addItem(e)))}_onMessage(e){switch(e.func){case"addItem":{this._addItem(e.payload);const s=this.get("_items");this.set("_items",s.concat(e.payload)),this.save_changes();break}}}_addItem(e){if(!this._palette)return;const{id:s,category:i,args:t,rank:o}=e,l=`${s}-${i}`;if(n.customItems.has(l))return;const d=this._palette.addItem({command:s,category:i,args:t,rank:o});n.customItems.set(l,d)}}_.serializers=Object.assign({},l.DOMWidgetModel.serializers),_.model_name="CommandPaletteModel",_.model_module=a.o,_.model_module_version=a.Y,_.view_name=null,_.view_module=null,_.view_module_version=a.Y,function(e){e.customItems=new o.ObservableMap}(n||(n={}));class r extends l.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:r.model_name,_model_module:r.model_module,_model_module_version:r.model_module_version,current_session:null,sessions:[]})}initialize(e,s){const{labShell:i,sessions:t,shell:n}=r;this._sessions=t,this._shell=n,this._labShell=i,t.runningChanged.connect(this._sendSessions,this),super.initialize(e,s),this.on("msg:custom",this._onMessage.bind(this)),this._labShell?(this._labShell.currentChanged.connect(this._currentChanged,this),this._labShell.activeChanged.connect(this._currentChanged,this)):this._currentChanged(),this._sendSessions(),this._sendCurrent(),this.send({event:"sessions_initialized"},{})}_onMessage(e){"refreshRunning"===e.func&&this._sessions.refreshRunning().then((()=>{this.send({event:"sessions_refreshed"},{})}))}_getSessionContext(e){var s,i,t;return null!==(t=null===(i=null===(s=null==e?void 0:e.sessionContext)||void 0===s?void 0:s.session)||void 0===i?void 0:i.model)&&void 0!==t?t:{}}_currentChanged(){this._current_session=this._getSessionContext(this._shell.currentWidget),this.set("current_session",this._current_session),this.set("sessions",(0,d.toArray)(this._sessions.running())),this.save_changes()}_sendSessions(){this.set("sessions",(0,d.toArray)(this._sessions.running())),this.save_changes()}_sendCurrent(){this._current_session=this._getSessionContext(this._shell.currentWidget),this.set("current_session",this._current_session),this.save_changes()}}r.serializers=Object.assign({},l.WidgetModel.serializers),r.model_name="SessionManagerModel",r.model_module=a.o,r.model_module_version=a.Y,r.view_name=null,r.view_module=null,r.view_module_version=a.Y;class c extends l.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:c.model_name,_model_module:c.model_module,_model_module_version:c.model_module_version})}initialize(e,s){this._app=c.app,super.initialize(e,s),this.send({event:"lab_ready"},{}),this.set("version",this._app.version),this.save_changes()}}c.serializers=Object.assign({},l.DOMWidgetModel.serializers),c.model_name="JupyterFrontEndModel",c.model_module=a.o,c.model_module_version=a.Y,c.view_name=null,c.view_module=null,c.view_module_version=a.Y;var h=i(246);class u extends h.VBoxModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:u.model_name,_model_module:u.model_module,_model_module_version:u.model_module_version})}}u.model_name="PanelModel",u.model_module=a.o,u.model_module_version=a.Y;var g=i(884),v=i(720);class p extends l.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:p.model_name,_model_module:p.model_module,_model_module_version:p.model_module_version,_widgets:[]})}initialize(e,s){this._shell=p.shell,this._labShell=p.labShell,super.initialize(e,s),this.on("msg:custom",this._onMessage.bind(this)),this.get("_widgets").forEach((e=>this._add(e)))}async _add(e){const{serializedWidget:s,area:i,args:t,id:n}=e,o=await(0,l.unpack_models)(s,this.widget_manager),a=await this.widget_manager.create_view(o,{}),m=await(0,l.unpack_models)(o.get("title"),this.widget_manager),_=a.luminoWidget;_.id=null!=n?n:g.DOMUtils.createDomID(),v.MessageLoop.installMessageHook(_,((e,s)=>{switch(s.type){case"close-request":{const s=this.get("_widgets").slice();d.ArrayExt.removeAllWhere(s,(s=>s.id===e.id)),this.set("_widgets",s),this.save_changes();break}}return!0}));const r=async()=>{const e=await(0,l.unpack_models)(m.get("icon"),this.widget_manager);_.title.label=m.get("label"),_.title.iconClass=e?null:m.get("icon_class"),_.title.icon=e?e.labIcon:null,_.title.closable=m.get("closable")};if(m.on("change",r),r(),("left"===i||"right"===i)&&this._labShell){let e;e="left"===i?this._labShell._leftHandler:this._labShell._rightHandler,e.sideBar.tabCloseRequested.connect(((e,s)=>{s.title.owner.close()})),_.addClass("jp-SideAreaWidget")}return this._shell.add(_,i,t),_.id}async _onMessage(e){switch(e.func){case"add":{const s=await this._add(e.payload),i=this.get("_widgets");this.set("_widgets",i.concat(Object.assign(Object.assign({},e.payload),{id:s}))),this.save_changes();break}case"expandLeft":this._labShell&&this._labShell.expandLeft();break;case"expandRight":this._labShell&&this._labShell.expandRight()}}}p.serializers=Object.assign({},l.WidgetModel.serializers),p.model_name="ShellModel",p.model_module=a.o,p.model_module_version=a.Y,p.view_name=null,p.view_module=null,p.view_module_version=a.Y;var w=i(431),b=i(755),M=i.n(b);class C extends w.SplitPanel{constructor(e){const s=e.view;delete e.view,super(e),this.addClass("jp-JupyterLuminoSplitPanelWidget"),this._view=s}processMessage(e){super.processMessage(e),this._view.processLuminoMessage(e)}dispose(){this.isDisposed||(super.dispose(),this._view&&this._view.remove(),this._view=null)}}class f extends u{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:f.model_name,_model_module:f.model_module,_model_module_version:f.model_module_version,_view_name:f.model_name,_view_module:f.model_module,_view_module_version:f.model_module_version})}}f.model_name="SplitPanelModel",f.model_module=a.o,f.model_module_version=a.Y,f.view_name="SplitPanelView",f.view_module=a.o,f.view_module_name=a.Y;class O extends h.VBoxView{_createElement(e){return this.luminoWidget=new C({view:this,orientation:this.model.get("orientation")}),this.luminoWidget.node}_setElement(e){if(this.el||e!==this.luminoWidget.node)throw new Error("Cannot reset the DOM element.");this.el=this.luminoWidget.node,this.$el=M()(this.luminoWidget.node)}initialize(e){super.initialize(e);const s=this.luminoWidget;this.model.on("change:orientation",(()=>{const e=this.model.get("orientation");s.orientation=e}))}async render(){super.render(),(await Promise.all(this.children_views.views)).forEach((async e=>{this.luminoWidget.addWidget(e.luminoWidget)}))}}class y extends l.WidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:y.model_name,_model_module:y.model_module,_model_module_version:y.model_module_version})}initialize(e,s){super.initialize(e,s),this.on("change:icon",this.iconChanged)}async iconChanged(){const e=await(0,l.unpack_models)(this.get("icon"),this.widget_manager);e&&e.on("change",(()=>this.trigger("change")))}}y.model_name="TitleModel",y.model_module=a.o,y.model_module_version=a.Y,y.view_name=null,y.view_module=null,y.view_module_version=a.Y;var S=i(215);class x extends l.DOMWidgetView{initialize(e){super.initialize(e),this.iconElement=document.createElement("div"),this.el.appendChild(this.iconElement),this.update()}update(){const{labIcon:e}=this.model;e&&e.render(this.iconElement,{props:{tag:"div"}})}}class z extends l.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:z.model_name,_model_module:z.model_module,_model_module_version:z.model_module_version,_view_name:z.view_name,_view_module:z.view_module,_view_module_version:z.view_module_version})}initialize(e,s){super.initialize(e,s),this.on("change:name change:svgstr",this.updateIcon),this.updateIcon()}get labIcon(){return this._labIcon}updateIcon(){const e=this.get("name"),s=this.get("svgstr");this._labIcon&&this._labIcon.name===e||(this._labIcon=new S.LabIcon({name:e,svgstr:s})),this._labIcon.svgstr=s,this.trigger("change")}}z.model_name="IconModel",z.model_module=a.o,z.model_module_version=a.Y,z.view_name="IconView",z.view_module=a.o,z.view_module_version=a.Y}}]);