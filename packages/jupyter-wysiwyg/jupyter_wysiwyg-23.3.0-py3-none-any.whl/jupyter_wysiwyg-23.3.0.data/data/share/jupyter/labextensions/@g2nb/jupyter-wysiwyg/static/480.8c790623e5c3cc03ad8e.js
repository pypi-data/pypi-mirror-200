"use strict";(self.webpackChunk_g2nb_jupyter_wysiwyg=self.webpackChunk_g2nb_jupyter_wysiwyg||[]).push([[480],{649:(e,t,n)=>{n.d(t,{x:()=>d,L:()=>_});var r=n(952),s=n(526),i=n(840),o=n(923),l=n(918),c=n(871),u=n(967),a=n.n(u);n(890),n(860),n(608),n(400),n(190),n(835),n(414),n(682),n(236),n(619);class d{constructor(e,t){this._uuid="",this._is_disposed=!1,this._keydownHandlers=new Array,this.is_markdown=!1,this.edgeRequested=new i.Signal(this),this.host=e.host,this.host.classList.add("jp-RenderedHTMLCommon"),this.host.classList.add("jp-TinyMCE"),this.host.addEventListener("focus",this.blur,!0),this.host.addEventListener("blur",this.focus,!0),this.host.addEventListener("scroll",this.scroll,!0),this._uuid=e.uuid||s.UUID.uuid4(),this._model=e.model,this.is_markdown=t.metadata.get("markdownMode"),this.is_markdown&&(this.is_markdown=!1),this._view=new _(this.host,this.model)}get view(){return this._view}get uuid(){return this._uuid}get is_disposed(){return this._is_disposed}get model(){return this._model}get lineCount(){return d.DEFAULT_NUMBER}get selectionStyle(){return this._selection_style}get doc(){return new h}set uuid(e){this._uuid=e}set selectionStyle(e){this._selection_style=e}blur(){this._view&&this._view.blur()}focus(){this._view&&this._view.focus()}addKeydownHandler(e){return this._keydownHandlers.push(e),new o.DisposableDelegate((()=>{l.ArrayExt.removeAllWhere(this._keydownHandlers,(t=>t===e))}))}dispose(){this._is_disposed||(this._is_disposed=!0,this.host.removeEventListener("focus",this.focus,!0),this.host.removeEventListener("focus",this.blur,!0),this.host.removeEventListener("focus",this.scroll,!0),i.Signal.clearData(this))}refresh(){const e=c.XY.instance().tracker.activeCell;e instanceof r.MarkdownCell&&!e.rendered&&c.XY.instance().no_side_button()&&(e.editor.focus(),c.XY.instance().render_side_button())}getCursorPosition(){return new class{}}getCursor(){return this.getCursorPosition()}clearHistory(){}scroll(){}getCoordinateForPosition(e){}getLine(e){}getOffsetAt(e){return 0}getOption(e){}getPositionAt(e){}getPositionForCoordinate(e){}getSelection(){}getSelections(){return[]}getTokenForPosition(e){}getTokens(){return[]}hasFocus(){return!1}newIndentedLine(){}operation(e){}redo(){}removeOverlay(e){}resizeToFit(){}revealPosition(e){}revealSelection(e){}setCursorPosition(e){}setOption(e,t){}setOptions(e){}setSelection(e){}setSelections(e){}setSize(e){}undo(){}firstLine(){return""}lastLine(){return""}}d.DEFAULT_NUMBER=0;class h{sliceString(e,t){return""}toString(){return""}get length(){return 0}lineAt(e){return""}line(e){return""}firstLine(){return""}lastLine(){return""}getSelection(){return""}getRange(e,t){return""}removeOverlay(e){}}class _{constructor(e,t){const n=document.createElement("div");e.appendChild(n),setTimeout((()=>{var r;const s=null===(r=null==e?void 0:e.parentElement)||void 0===r?void 0:r.querySelector(".jp-MarkdownOutput");s&&s.querySelectorAll(".jp-InternalAnchorLink").forEach((e=>e.remove())),n.innerHTML=(null==s?void 0:s.innerHTML)||t.value.text;try{a().init({target:n,skin:!1,content_css:!1,branding:!1,contextmenu:!1,elementpath:!1,menubar:!1,height:300,resize:!1,plugins:"emoticons lists link code",toolbar:"styleselect fontsizeselect | bold italic underline strikethrough | subscript superscript | link forecolor backcolor emoticons | bullist numlist outdent indent blockquote | code",init_instance_callback:e=>e.on("Change",(()=>t.value.text=e.getContent()))}).then((e=>{e.length&&e[0].on("focus",(()=>{const e=this.get_cell_index(t);null!==e&&(c.XY.instance().tracker.currentWidget.content.activeCellIndex=e)}))}))}catch(e){console.log("TinyMCE threw an error: "+e)}}),500)}blur(){}focus(){}get_cell_index(e){const t=e.modelDB.basePath,n=c.XY.instance().tracker.currentWidget.content.widgets;for(let e=0;e<n.length;e++)if(t===n[e].model.modelDB.basePath)return e;return null}}},871:(e,t,n)=>{n.d(t,{Jm:()=>u,Oz:()=>a,XY:()=>d});var r=n(767),s=n(952),i=n(526),o=n(431),l=n(649),c=n(591);class u extends r.NotebookPanel.ContentFactory{constructor(e){super(e)}createMarkdownCell(e,t){const n=e.model;return e.contentFactory=new u({editorFactory:e=>new l.x(e,n)}),new s.MarkdownCell(e).initializeState()}}const a=new i.Token("jupyter-wysiwyg");class d extends o.Widget{constructor(){super()}static instance(){return d._singleton||(d._singleton=new d),d._singleton}get tracker(){return this._tracker}set tracker(e){this._tracker=e}get previous_cell(){return this._previous_cell}set previous_cell(e){this._previous_cell=e}no_side_button(){var e;return!(null===(e=this.sidebar(this._tracker.activeCell.node))||void 0===e?void 0:e.querySelector(".jp-RenderButton"))}render_side_button(){const e=this.sidebar(this._tracker.activeCell.node),t=this.run_button(this._tracker.activeCell,this._tracker.currentWidget);e.append(t)}remove_side_button(){var e;this._previous_cell&&(null===(e=this.sidebar(this._previous_cell.node).querySelector(".jp-RenderButton"))||void 0===e||e.remove()),this._previous_cell=this._tracker.activeCell}sidebar(e){var t;return null===(t=e.closest(".jp-Cell"))||void 0===t?void 0:t.querySelector(".jp-InputArea-prompt")}run_button(e,t){const n=document.createElement("button");return n.classList.add("jp-ToolbarButtonComponent","jp-Button","jp-RenderButton"),n.setAttribute("title","Render this cell"),n.innerHTML=c.runIcon.svgstr,n.addEventListener("click",(()=>{t.content.select(e),setTimeout((()=>{r.NotebookActions.runAndAdvance(t.content,t.sessionContext)}),200)})),n}}},480:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var r=n(767),s=n(952),i=n(397),o=n(871);n(549);const l=[{id:"@g2nb/jupyter-wysiwyg:plugin",requires:[r.INotebookTracker,i.IStateDB],activate:function(e,t,n){console.log("jupyter-wysiwyg plugin activated!"),o.XY.instance().tracker=t,t.currentChanged.connect((()=>{t.currentWidget&&t.activeCellChanged.connect((()=>{const e=t.activeCell;e instanceof s.MarkdownCell&&!e.rendered&&o.XY.instance().no_side_button()?(e.editor.focus(),o.XY.instance().render_side_button(),o.XY.instance().remove_side_button()):o.XY.instance().remove_side_button()}))}))},autoStart:!0},{id:"@g2nb/jupyter-wysiwyg:add-wysiwyg",provides:r.NotebookPanel.IContentFactory,activate:function(e){return console.log("jupyter-wysiwyg override activated!"),new o.Jm},autoStart:!0}]},760:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(645),s=n.n(r)()((function(e){return e[1]}));s.push([e.id,".jp-TinyMCE {\n    padding-right: 0;\n}\n\n.jp-TinyMCE > .tox-tinymce {\n    margin-bottom: 0;\n}\n\n.jp-RenderButton {\n    cursor: pointer;\n}\n\n.jp-RenderButton:hover {\n    background-color: var(--jp-layout-color2);\n}",""]);const i=s},549:(e,t,n)=>{var r=n(379),s=n.n(r),i=n(760);s()(i.Z,{insert:"head",singleton:!1}),i.Z.locals}}]);